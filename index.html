<!doctype html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>PIMX_WEATHER</title>
  <meta name="description" content="پیش‌بینی دقیق و لحظه‌ای وضعیت هوا با جستجوی شهر و تشخیص خودکار موقعیت.">
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body class="theme-default">
  <!-- Loading Screen -->
  <div id="loadingScreen" class="loading-screen">
    <div class="loading-content">
      <div class="loading-weather-icon">
        <div class="loading-sun">
          <div class="loading-sun-core"></div>
          <div class="loading-sun-rays"></div>
        </div>
        <div class="loading-cloud"></div>
      </div>
      <h2 class="loading-title">PIMX_WEATHER</h2>
      <div class="loading-bar">
        <div class="loading-bar-fill"></div>
      </div>
      <p class="loading-text">در حال بارگذاری اطلاعات...</p>
    </div>
  </div>

  <header class="app-header">
    <div class="brand">
      <span class="logo" aria-hidden="true">☀️</span>
      <h1 data-i18n="appName">PIMX_WEATHER</h1>
    </div>
    <div class="controls">
      <div class="search">
        <input id="searchInput" type="text" placeholder="شهر را جستجو کنید..." data-i18n="searchPlaceholder" autocomplete="off" aria-label="جستجوی شهر">
        <button id="useLocation" class="button secondary" title="استفاده از موقعیت من"><span data-i18n="useLocation">📍 موقعیت من</span></button>
        <div id="suggestions" class="suggestions" role="listbox" aria-label="نتایج جستجو"></div>
      </div>
      <div class="lang-toggle" role="group" aria-label="Language">
        <button id="langFa" class="lang-btn" data-lang="fa" title="فارسی">FA</button>
        <button id="langEn" class="lang-btn active" data-lang="en" title="English">EN</button>
      </div>
      <div class="unit-toggle" role="group" aria-label="واحد دما">
        <button id="unitC" class="unit active" data-unit="C" aria-pressed="true" title="سانتی‌گراد">°C</button>
        <button id="unitF" class="unit" data-unit="F" aria-pressed="false" title="فارنهایت">°F</button>
      </div>
    </div>
  </header>

  <main class="app-main">
    <section class="card city-card">
      <div class="city-header">
        <h3 data-i18n="savedCities">شهرهای ذخیره‌شده</h3>
        <button id="addCity" class="button secondary" title="افزودن شهر فعلی"><span data-i18n="addCity">+ افزودن</span></button>
      </div>
      <div id="cityTabs" class="city-tabs"></div>
    </section>

    <section id="current" class="card current-card" aria-live="polite">
      <div class="current-header">
        <div class="header-top">
          <h2 id="placeName">—</h2>
          <div class="local-time" id="localTime">—</div>
        </div>
        <div class="date-selector">
          <button type="button" id="prevDay" class="date-nav" title="روز قبل">‹</button>
          <div id="selectedDate" class="selected-date" data-i18n="today">امروز</div>
          <button type="button" id="nextDay" class="date-nav" title="روز بعد">›</button>
        </div>
        <div class="updated" id="updatedAt">—</div>
      </div>
      <div class="current-body">
        <div id="currentIcon" class="wx-icon" aria-hidden="true"></div>
        <div class="measurements">
          <div class="temp-row">
            <span id="temp" class="temp-large">—</span>
            <span id="condition" class="condition">—</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Stats Cards با طراحی جدید -->
    <section class="stats-grid">
      <div class="stat-card temp-card">
        <div class="stat-icon">🌡️</div>
        <div class="stat-content">
          <div class="stat-label" data-i18n="feelsLike">حس‌شده</div>
          <div class="stat-value" id="feelsLike">—</div>
        </div>
        <div class="stat-bar">
          <div class="stat-bar-fill" id="feelsLikeBar"></div>
        </div>
      </div>

      <div class="stat-card humidity-card">
        <div class="stat-icon">💧</div>
        <div class="stat-content">
          <div class="stat-label" data-i18n="humidity">رطوبت</div>
          <div class="stat-value" id="humidity">—</div>
        </div>
        <div class="stat-bar">
          <div class="stat-bar-fill" id="humidityBar"></div>
        </div>
      </div>

      <div class="stat-card wind-card">
        <div class="stat-icon">💨</div>
        <div class="stat-content">
          <div class="stat-label" data-i18n="wind">باد</div>
          <div class="stat-value" id="wind">—</div>
        </div>
        <div class="stat-bar">
          <div class="stat-bar-fill" id="windBar"></div>
        </div>
      </div>

      <div class="stat-card pressure-card">
        <div class="stat-icon">🔽</div>
        <div class="stat-content">
          <div class="stat-label" data-i18n="pressure">فشار</div>
          <div class="stat-value" id="pressure">—</div>
        </div>
        <div class="stat-bar">
          <div class="stat-bar-fill" id="pressureBar"></div>
        </div>
      </div>

      <div class="stat-card visibility-card">
        <div class="stat-icon">👁️</div>
        <div class="stat-content">
          <div class="stat-label" data-i18n="visibility">دید</div>
          <div class="stat-value" id="visibility">—</div>
        </div>
        <div class="stat-bar">
          <div class="stat-bar-fill" id="visibilityBar"></div>
        </div>
      </div>

      <div class="stat-card dew-card">
        <div class="stat-icon">💦</div>
        <div class="stat-content">
          <div class="stat-label" data-i18n="dewpoint">نقطه شبنم</div>
          <div class="stat-value" id="dewpoint">—</div>
        </div>
      </div>

      <div class="stat-card rain-card">
        <div class="stat-icon">🌧️</div>
        <div class="stat-content">
          <div class="stat-label" data-i18n="precipitation">بارش</div>
          <div class="stat-value" id="precip">—</div>
        </div>
        <div class="stat-bar">
          <div class="stat-bar-fill" id="precipBar"></div>
        </div>
      </div>

      <div class="stat-card uv-card">
        <div class="stat-icon">☀️</div>
        <div class="stat-content">
          <div class="stat-label" data-i18n="uvIndex">شاخص UV</div>
          <div class="stat-value" id="uvIndex">—</div>
        </div>
        <div class="stat-bar">
          <div class="stat-bar-fill" id="uvBar"></div>
        </div>
      </div>

      <div class="stat-card aqi-card">
        <div class="stat-icon">🏭</div>
        <div class="stat-content">
          <div class="stat-label" data-i18n="airQuality">کیفیت هوا</div>
          <div class="stat-value" id="aqi">—</div>
        </div>
        <div class="stat-bar">
          <div class="stat-bar-fill" id="aqiBar"></div>
        </div>
      </div>

      <div class="stat-card sunrise-card">
        <div class="stat-icon">🌅</div>
        <div class="stat-content">
          <div class="stat-label" data-i18n="sunrise">طلوع</div>
          <div class="stat-value" id="sunrise">—</div>
        </div>
      </div>

      <div class="stat-card sunset-card">
        <div class="stat-icon">🌇</div>
        <div class="stat-content">
          <div class="stat-label" data-i18n="sunset">غروب</div>
          <div class="stat-value" id="sunset">—</div>
        </div>
      </div>

      <div class="stat-card moon-card">
        <div class="stat-icon">🌙</div>
        <div class="stat-content">
          <div class="stat-label" data-i18n="moonPhase">فاز ماه</div>
          <div class="stat-value" id="moonPhase">—</div>
        </div>
      </div>
    </section>

    <section id="hourly" class="card">
      <h3 data-i18n="upcomingHours">ساعت‌های آینده</h3>
      <div id="hourlyList" class="scroller hours"></div>
    </section>

    <section id="daily" class="card">
      <div class="section-header">
        <h3 data-i18n="dailyForecast">پیش‌بینی روزانه</h3>
        <div class="view-controls">
          <button id="view7d" class="view-btn active" data-days="7" data-i18n="days7">۷ روز</button>
          <button id="view14d" class="view-btn" data-days="14" data-i18n="days14">۱۴ روز</button>
        </div>
      </div>
      <div id="dailyList" class="days"></div>
    </section>

    <section class="card">
      <h3 data-i18n="precipHistory">📊 آمار تاریخی بارندگی</h3>
      <div class="history-tabs">
        <button class="history-tab active" data-period="week" data-i18n="lastWeek">هفته گذشته</button>
        <button class="history-tab" data-period="month" data-i18n="lastMonth">ماه گذشته</button>
        <button class="history-tab" data-period="6months" data-i18n="last6Months">۶ ماه گذشته</button>
        <button class="history-tab" data-period="year" data-i18n="lastYear">سال گذشته</button>
      </div>
      <div class="chart-container">
        <canvas id="precipChart"></canvas>
      </div>
      <div id="historyStats" class="history-stats"></div>
    </section>

    <section class="card">
      <h3 data-i18n="tempHistory">🌡️ آمار تاریخی دما</h3>
      <div class="chart-container">
        <canvas id="tempChart"></canvas>
      </div>
    </section>

    <section class="card astronomy-card">
      <h3 data-i18n="sunMoon">☀️ خورشید و ماه</h3>
      
      <div class="sun-moon-track">
        <h4><span data-i18n="sunPosition">موقعیت خورشید</span> <span style="font-size: 11px; color: var(--muted); font-weight: 400;" data-i18n="sunPositionDesc">(نمودار زنده حرکت خورشید در طول روز)</span></h4>
        
        <!-- جزئیات کامل خورشید -->
        <div class="sun-details-grid">
          <div class="sun-detail-card">
            <div class="detail-icon">🌅</div>
            <div class="detail-label" data-i18n="sunriseTime">طلوع خورشید</div>
            <div class="detail-value" id="sunRiseDetail">—</div>
          </div>
          
          <div class="sun-detail-card">
            <div class="detail-icon">🌇</div>
            <div class="detail-label" data-i18n="sunsetTime">غروب خورشید</div>
            <div class="detail-value" id="sunSetDetail">—</div>
          </div>
          
          <div class="sun-detail-card">
            <div class="detail-icon">⏱️</div>
            <div class="detail-label" data-i18n="dayLength">طول روز</div>
            <div class="detail-value" id="sunDayLengthDetail">—</div>
          </div>
          
          <div class="sun-detail-card">
            <div class="detail-icon">🌞</div>
            <div class="detail-label" data-i18n="solarNoon">اوج خورشید</div>
            <div class="detail-value" id="sunSolarNoonDetail">—</div>
          </div>
          
          <div class="sun-detail-card">
            <div class="detail-icon">📐</div>
            <div class="detail-label" data-i18n="sunAltitude">زاویه خورشید</div>
            <div class="detail-value" id="sunAltitudeDetail">—</div>
          </div>
          
          <div class="sun-detail-card">
            <div class="detail-icon">🧭</div>
            <div class="detail-label" data-i18n="sunAzimuth">سمت خورشید</div>
            <div class="detail-value" id="sunAzimuthDetail">—</div>
          </div>
          
          <div class="sun-detail-card">
            <div class="detail-icon">⬆️</div>
            <div class="detail-label" data-i18n="maxAltitude">حداکثر ارتفاع</div>
            <div class="detail-value" id="sunMaxAltitudeDetail">—</div>
          </div>
          
          <div class="sun-detail-card">
            <div class="detail-icon">🌍</div>
            <div class="detail-label" data-i18n="distanceFromSun">فاصله از خورشید</div>
            <div class="detail-value" id="sunDistanceDetail">—</div>
          </div>
        </div>
        
        <div class="track-container">
          <div class="progress-track sun-track arc-track">
            <svg class="track-arc-svg" viewBox="0 0 600 220" preserveAspectRatio="xMidYMid meet">
              <defs>
                <linearGradient id="sunGradient" x1="0%" y1="100%" x2="100%" y2="100%">
                  <stop offset="0%" style="stop-color:rgba(255,150,100,0.4);stop-opacity:1" />
                  <stop offset="50%" style="stop-color:rgba(255,220,100,0.8);stop-opacity:1" />
                  <stop offset="100%" style="stop-color:rgba(255,100,100,0.4);stop-opacity:1" />
                </linearGradient>
                <filter id="glow">
                  <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                  <feMerge>
                    <feMergeNode in="coloredBlur"/>
                    <feMergeNode in="SourceGraphic"/>
                  </feMerge>
                </filter>
              </defs>
              <!-- خط افق -->
              <line x1="50" y1="160" x2="550" y2="160" stroke="rgba(255,255,255,0.25)" stroke-width="2" stroke-dasharray="5,5"/>
              <!-- زمینه آسمان -->
              <path d="M 50,160 Q 300,30 550,160 L 550,200 L 50,200 Z" fill="rgba(135,206,235,0.08)"/>
              <!-- قوس مسیر خورشید -->
              <path id="sunArcPath" d="M 50,160 Q 300,30 550,160" fill="none" stroke="url(#sunGradient)" stroke-width="5" stroke-linecap="round"/>
              <!-- خطوط کمکی عمودی -->
              <line x1="175" y1="160" x2="175" y2="100" stroke="rgba(255,255,255,0.1)" stroke-width="1" stroke-dasharray="2,3"/>
              <line x1="300" y1="160" x2="300" y2="30" stroke="rgba(255,255,255,0.1)" stroke-width="1" stroke-dasharray="2,3"/>
              <line x1="425" y1="160" x2="425" y2="100" stroke="rgba(255,255,255,0.1)" stroke-width="1" stroke-dasharray="2,3"/>
              <!-- نقاط زمانی بزرگتر -->
              <circle cx="175" cy="100" r="3" fill="rgba(255,220,100,0.6)" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
              <circle cx="300" cy="30" r="3" fill="rgba(255,220,100,0.8)" stroke="rgba(255,255,255,0.4)" stroke-width="1"/>
              <circle cx="425" cy="100" r="3" fill="rgba(255,180,100,0.6)" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
              <!-- برچسب زمانی بزرگتر و واضح‌تر -->
              <text x="175" y="120" text-anchor="middle" font-size="13" fill="rgba(255,255,255,0.7)" font-family="Vazirmatn" font-weight="600" class="time-label-am9" data-i18n="am9">۹ صبح</text>
              <text x="300" y="20" text-anchor="middle" font-size="14" fill="rgba(255,255,255,0.85)" font-family="Vazirmatn" font-weight="700" class="time-label-pm12" data-i18n="pm12">۱۲ ظهر</text>
              <text x="425" y="120" text-anchor="middle" font-size="13" fill="rgba(255,255,255,0.7)" font-family="Vazirmatn" font-weight="600" class="time-label-pm3" data-i18n="pm3">۳ بعدازظهر</text>
              <!-- نقطه طلوع -->
              <text x="50" y="185" text-anchor="middle" font-size="28">🌅</text>
              <text x="50" y="205" text-anchor="middle" font-size="11" fill="rgba(255,255,255,0.7)" font-family="Vazirmatn" font-weight="600" id="sunRiseTimeLabel">—</text>
              <!-- نقطه غروب -->
              <text x="550" y="185" text-anchor="middle" font-size="28">🌇</text>
              <text x="550" y="205" text-anchor="middle" font-size="11" fill="rgba(255,255,255,0.7)" font-family="Vazirmatn" font-weight="600" id="sunSetTimeLabel">—</text>
              <!-- موقعیت فعلی خورشید -->
              <g id="sunPositionMarker" filter="url(#glow)">
                <circle cx="250" cy="95" r="35" fill="rgba(255,200,100,0.12)" stroke="rgba(255,200,100,0.4)" stroke-width="2"/>
                <circle cx="250" cy="95" r="24" fill="rgba(255,220,100,0.2)"/>
                <text x="250" y="108" text-anchor="middle" font-size="38">☀️</text>
                <!-- زاویه خورشید همیشه نمایان -->
                <text x="250" y="55" text-anchor="middle" font-size="16" fill="rgba(255,220,100,1)" font-family="Vazirmatn" font-weight="700" id="sunAngleText">—°</text>
                <!-- باکس اطلاعات خورشید (مخفی به صورت پیش‌فرض) -->
                <g id="sunInfoBox" style="opacity: 0; pointer-events: none; transition: opacity 0.3s ease;">
                  <rect x="260" y="60" width="100" height="55" rx="8" fill="rgba(0,0,0,0.75)" stroke="rgba(255,200,100,0.5)" stroke-width="1.5"/>
                  <text x="310" y="78" text-anchor="middle" font-size="11" fill="rgba(255,220,100,1)" font-family="Vazirmatn" font-weight="700" id="sunPercentText">—%</text>
                  <text x="310" y="92" text-anchor="middle" font-size="9" fill="rgba(255,255,255,0.8)" font-family="Vazirmatn" id="sunTimeLeftText">—</text>
                  <text x="310" y="106" text-anchor="middle" font-size="9" fill="rgba(255,255,255,0.7)" font-family="Vazirmatn" id="sunAltText">—</text>
                </g>
              </g>
            </svg>
          </div>
          <div id="sunAltitudeArc" class="altitude-arc"></div>
          <div class="track-status" id="sunStatus">—</div>
        </div>
      </div>

      <div class="sun-moon-track">
        <h4 data-i18n="moonPosition">موقعیت ماه</h4>
        <div class="moon-visual">
          <div class="moon-canvas-container">
            <div id="moonCanvas" class="moon-canvas"></div>
          </div>
          <div class="moon-info">
            <div class="moon-phase-name" id="moonPhaseNameBig">—</div>
            <div class="moon-illumination" id="moonIllumination">—</div>
          </div>
        </div>
        
        <!-- جزئیات کامل ماه -->
        <div class="moon-details-grid">
          <div class="moon-detail-card">
            <div class="detail-icon">🌕</div>
            <div class="detail-label" data-i18n="moonPhaseDetail">فاز ماه</div>
            <div class="detail-value" id="moonPhaseDetail">—</div>
          </div>
          
          <div class="moon-detail-card">
            <div class="detail-icon">💡</div>
            <div class="detail-label" data-i18n="illumination">روشنایی</div>
            <div class="detail-value" id="moonIlluminationDetail">—</div>
          </div>
          
          <div class="moon-detail-card">
            <div class="detail-icon">📅</div>
            <div class="detail-label" data-i18n="moonAge">عمر ماه</div>
            <div class="detail-value" id="moonAgeDetail">—</div>
          </div>
          
          <div class="moon-detail-card">
            <div class="detail-icon">🌜</div>
            <div class="detail-label" data-i18n="moonrise">طلوع ماه</div>
            <div class="detail-value" id="moonRiseDetail">—</div>
          </div>
          
          <div class="moon-detail-card">
            <div class="detail-icon">🌛</div>
            <div class="detail-label" data-i18n="moonset">غروب ماه</div>
            <div class="detail-value" id="moonSetDetail">—</div>
          </div>
          
          <div class="moon-detail-card">
            <div class="detail-icon">⏱️</div>
            <div class="detail-label" data-i18n="moonDuration">مدت حضور</div>
            <div class="detail-value" id="moonDurationDetail">—</div>
          </div>
          
          <div class="moon-detail-card">
            <div class="detail-icon">📐</div>
            <div class="detail-label" data-i18n="moonAltitude">زاویه ماه</div>
            <div class="detail-value" id="moonAltitudeDetail">—</div>
          </div>
          
          <div class="moon-detail-card">
            <div class="detail-icon">📏</div>
            <div class="detail-label" data-i18n="distanceFromEarth">فاصله از زمین</div>
            <div class="detail-value" id="moonDistanceDetail">—</div>
          </div>
        </div>
        <div class="track-container">
          <div class="progress-track moon-track arc-track">
            <svg class="track-arc-svg" viewBox="0 0 600 220" preserveAspectRatio="xMidYMid meet">
              <defs>
                <linearGradient id="moonGradient" x1="0%" y1="100%" x2="100%" y2="100%">
                  <stop offset="0%" style="stop-color:rgba(150,180,220,0.3);stop-opacity:1" />
                  <stop offset="50%" style="stop-color:rgba(200,220,255,0.7);stop-opacity:1" />
                  <stop offset="100%" style="stop-color:rgba(150,180,220,0.3);stop-opacity:1" />
                </linearGradient>
                <filter id="moonGlow">
                  <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                  <feMerge>
                    <feMergeNode in="coloredBlur"/>
                    <feMergeNode in="SourceGraphic"/>
                  </feMerge>
                </filter>
              </defs>
              <!-- خط افق -->
              <line x1="50" y1="160" x2="550" y2="160" stroke="rgba(255,255,255,0.25)" stroke-width="2" stroke-dasharray="5,5"/>
              <!-- زمینه آسمان شب -->
              <path d="M 50,160 Q 300,30 550,160 L 550,200 L 50,200 Z" fill="rgba(100,120,180,0.06)"/>
              <!-- قوس مسیر ماه -->
              <path id="moonArcPath" d="M 50,160 Q 300,30 550,160" fill="none" stroke="url(#moonGradient)" stroke-width="5" stroke-linecap="round"/>
              <!-- ستاره‌های دکوراتیو بزرگتر -->
              <circle cx="100" cy="70" r="2" fill="rgba(255,255,255,0.7)">
                <animate attributeName="opacity" values="0.3;1;0.3" dur="3s" repeatCount="indefinite"/>
              </circle>
              <circle cx="500" cy="80" r="2" fill="rgba(255,255,255,0.7)">
                <animate attributeName="opacity" values="1;0.3;1" dur="2.5s" repeatCount="indefinite"/>
              </circle>
              <circle cx="180" cy="45" r="1.5" fill="rgba(255,255,255,0.5)">
                <animate attributeName="opacity" values="0.5;1;0.5" dur="4s" repeatCount="indefinite"/>
              </circle>
              <circle cx="420" cy="60" r="1.5" fill="rgba(255,255,255,0.5)">
                <animate attributeName="opacity" values="1;0.5;1" dur="3.5s" repeatCount="indefinite"/>
              </circle>
              <circle cx="240" cy="50" r="1.5" fill="rgba(255,255,255,0.6)">
                <animate attributeName="opacity" values="0.4;0.9;0.4" dur="5s" repeatCount="indefinite"/>
              </circle>
              <circle cx="360" cy="90" r="1.5" fill="rgba(255,255,255,0.6)">
                <animate attributeName="opacity" values="0.8;0.4;0.8" dur="4.5s" repeatCount="indefinite"/>
              </circle>
              <!-- نقطه طلوع -->
              <text x="50" y="185" text-anchor="middle" font-size="28">🌜</text>
              <text x="50" y="205" text-anchor="middle" font-size="11" fill="rgba(255,255,255,0.7)" font-family="Vazirmatn" font-weight="600" id="moonRiseTimeLabel">—</text>
              <!-- نقطه غروب -->
              <text x="550" y="185" text-anchor="middle" font-size="28">🌛</text>
              <text x="550" y="205" text-anchor="middle" font-size="11" fill="rgba(255,255,255,0.7)" font-family="Vazirmatn" font-weight="600" id="moonSetTimeLabel">—</text>
              <!-- موقعیت فعلی ماه -->
              <g id="moonPositionMarker" filter="url(#moonGlow)">
                <circle cx="250" cy="95" r="32" fill="rgba(200,220,255,0.1)" stroke="rgba(200,220,255,0.35)" stroke-width="2"/>
                <circle cx="250" cy="95" r="22" fill="rgba(200,220,255,0.18)"/>
                <text x="250" y="107" text-anchor="middle" font-size="34">🌙</text>
                <!-- زاویه ماه همیشه نمایان -->
                <text x="250" y="55" text-anchor="middle" font-size="16" fill="rgba(200,220,255,1)" font-family="Vazirmatn" font-weight="700" id="moonAngleText">—°</text>
                <!-- باکس اطلاعات ماه (مخفی به صورت پیش‌فرض) -->
                <g id="moonInfoBox" style="opacity: 0; pointer-events: none; transition: opacity 0.3s ease;">
                  <rect x="260" y="60" width="100" height="55" rx="8" fill="rgba(0,0,0,0.75)" stroke="rgba(200,220,255,0.5)" stroke-width="1.5"/>
                  <text x="310" y="78" text-anchor="middle" font-size="11" fill="rgba(200,220,255,1)" font-family="Vazirmatn" font-weight="700" id="moonPercentText">—%</text>
                  <text x="310" y="92" text-anchor="middle" font-size="9" fill="rgba(255,255,255,0.8)" font-family="Vazirmatn" id="moonTimeLeftText">—</text>
                  <text x="310" y="106" text-anchor="middle" font-size="9" fill="rgba(255,255,255,0.7)" font-family="Vazirmatn" id="moonPhaseText">—</text>
                </g>
              </g>
            </svg>
          </div>
          <div id="moonAltitudeArc" class="altitude-arc"></div>
          <div class="track-status" id="moonStatus">—</div>
        </div>
      </div>
    </section>

    <section class="card solar-system-card">
      <div class="solar-system-header">
        <h3 data-i18n="solarSystem">🪐 منظومه شمسی - موقعیت‌های واقعی نجومی</h3>
        <div class="time-controls">
          <label for="solarSystemHour" style="font-size: 13px; color: var(--muted);"><span data-i18n="hour">ساعت</span>:</label>
          <input type="range" id="solarSystemHour" min="0" max="23" value="12" step="1" style="width: 150px;">
          <span id="solarSystemHourDisplay" style="font-size: 14px; font-weight: 600; color: var(--accent); min-width: 50px; display: inline-block; text-align: center;">۱۲:۰۰</span>
          <button id="resetToNow" class="button secondary" style="padding: 6px 12px; font-size: 12px;" data-i18n="now">اکنون</button>
        </div>
      </div>
      <div class="zoom-controls">
        <button id="zoomIn" class="zoom-btn" title="بزرگنمایی">🔍+</button>
          <span id="zoomLevel" style="font-size: 12px; color: var(--muted); min-width: 50px; text-align: center;">—</span>
        <button id="zoomOut" class="zoom-btn" title="کوچک‌نمایی">🔍−</button>
        <button id="zoomReset" class="zoom-btn" title="بازنشانی" style="margin-left: 8px;">🔄</button>
      </div>
      <div id="solarSystem" class="solar-system-3d"></div>
      <div class="planet-info-box" id="planetInfoBox">
        <div style="font-size: 11px; color: var(--muted); margin-bottom: 8px;">
          💡 <span data-i18n="note">نکته</span>: <span data-i18n="solarSystemNote1">فواصل واقعی سیارات بسیار زیاد است. برای نمایش بهتر، از مقیاس فشرده استفاده شده است.</span>
        </div>
      </div>
      <div class="planet-legend">
        <div class="legend-item"><span class="legend-color" style="background: #8c7853;"></span> <span data-i18n="mercury">عطارد</span> (0.39 AU)</div>
        <div class="legend-item"><span class="legend-color" style="background: #e8cda2;"></span> <span data-i18n="venus">زهره</span> (0.72 AU)</div>
        <div class="legend-item"><span class="legend-color" style="background: #4a9fd8;"></span> <span data-i18n="earth">زمین</span> (1.00 AU)</div>
        <div class="legend-item"><span class="legend-color" style="background: #cd5c5c;"></span> <span data-i18n="mars">مریخ</span> (1.52 AU)</div>
        <div class="legend-item"><span class="legend-color" style="background: #d4a574;"></span> <span data-i18n="jupiter">مشتری</span> (5.20 AU)</div>
        <div class="legend-item"><span class="legend-color" style="background: #f4e7c4;"></span> <span data-i18n="saturn">زحل</span> (9.54 AU)</div>
        <div class="legend-item"><span class="legend-color" style="background: #4fd0e7;"></span> <span data-i18n="uranus">اورانوس</span> (19.19 AU)</div>
        <div class="legend-item"><span class="legend-color" style="background: #4166f5;"></span> <span data-i18n="neptune">نپتون</span> (30.07 AU)</div>
      </div>
      <div class="accuracy-note">
        <small>💡 <span data-i18n="solarSystemNote2">موقعیت سیارات با استفاده از الگوریتم‌های نجومی VSOP87 محاسبه شده و بر اساس تاریخ و ساعت انتخابی شما دقیق است.</span></small>
      </div>
    </section>
  </main>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <footer class="app-footer">
    <p>&copy; 2025 <a href="https://pimx.pages.dev" target="_blank" rel="noopener noreferrer">PIMX</a>. All rights reserved.</p>
  </footer>

  <noscript>برای استفاده از این برنامه، جاوااسکریپت باید فعال باشد.</noscript>
  <script src="i18n.js"></script>
  <script defer src="app.js"></script>
</body>
</html>
